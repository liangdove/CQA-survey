(torch) root@ygmmwcfeoxllsqsn-snow-6cd4d5f5dc-vh8sv:/data/coding/chartqa_test# python infer.py --split test --
cache_dir /data/coding/chartqa_data/HuggingFaceM4___chart_qa
Loading dataset from local path: /data/coding/chartqa_data/HuggingFaceM4___chart_qa
Evaluating on 2500 samples from test split...
  4%|██▊                                                                    | 99/2500 [01:15<22:30,  1.78it/s]Processed 100/2500, Accuracy: 0.5800
  8%|█████▌                                                                | 199/2500 [02:16<30:35,  1.25it/s]Processed 200/2500, Accuracy: 0.6050
 12%|████████▎                                                             | 299/2500 [03:27<26:18,  1.39it/s]Processed 300/2500, Accuracy: 0.6633
 16%|███████████▏                                                          | 399/2500 [04:40<24:47,  1.41it/s]Processed 400/2500, Accuracy: 0.6525
 20%|█████████████▉                                                        | 499/2500 [06:04<14:49,  2.25it/s]Processed 500/2500, Accuracy: 0.6540
 24%|████████████████▊                                                     | 599/2500 [07:22<22:38,  1.40it/s]Processed 600/2500, Accuracy: 0.6550
 28%|███████████████████▌                                                  | 699/2500 [08:34<21:24,  1.40it/s]Processed 700/2500, Accuracy: 0.6457
 32%|██████████████████████▎                                               | 799/2500 [09:48<19:37,  1.44it/s]Processed 800/2500, Accuracy: 0.6575
 36%|█████████████████████████▏                                            | 899/2500 [11:09<19:46,  1.35it/s]Processed 900/2500, Accuracy: 0.6544
 40%|███████████████████████████▉                                          | 999/2500 [12:21<16:53,  1.48it/s]Processed 1000/2500, Accuracy: 0.6630
 44%|██████████████████████████████▎                                      | 1099/2500 [13:33<15:48,  1.48it/s]Processed 1100/2500, Accuracy: 0.6555
 48%|█████████████████████████████████                                    | 1199/2500 [14:45<15:08,  1.43it/s]Processed 1200/2500, Accuracy: 0.6567
 52%|███████████████████████████████████▊                                 | 1299/2500 [15:57<14:11,  1.41it/s]Processed 1300/2500, Accuracy: 0.6662
 56%|██████████████████████████████████████▌                              | 1399/2500 [17:11<13:21,  1.37it/s]Processed 1400/2500, Accuracy: 0.6829
 60%|█████████████████████████████████████████▎                           | 1499/2500 [18:32<11:58,  1.39it/s]Processed 1500/2500, Accuracy: 0.6960
 64%|████████████████████████████████████████████▏                        | 1599/2500 [19:51<10:06,  1.49it/s]Processed 1600/2500, Accuracy: 0.7056
 68%|██████████████████████████████████████████████▉                      | 1699/2500 [21:09<10:42,  1.25it/s]Processed 1700/2500, Accuracy: 0.7124
 72%|█████████████████████████████████████████████████▋                   | 1799/2500 [22:28<08:52,  1.32it/s]Processed 1800/2500, Accuracy: 0.7156
 76%|████████████████████████████████████████████████████▍                | 1899/2500 [23:47<06:21,  1.57it/s]Processed 1900/2500, Accuracy: 0.7232
 80%|███████████████████████████████████████████████████████▏             | 1999/2500 [25:02<06:06,  1.37it/s]Processed 2000/2500, Accuracy: 0.7260
 84%|█████████████████████████████████████████████████████████▉           | 2099/2500 [26:20<05:17,  1.26it/s]Processed 2100/2500, Accuracy: 0.7338
 88%|████████████████████████████████████████████████████████████▋        | 2199/2500 [27:36<03:54,  1.28it/s]Processed 2200/2500, Accuracy: 0.7405
 92%|███████████████████████████████████████████████████████████████▍     | 2299/2500 [28:54<02:26,  1.37it/s]Processed 2300/2500, Accuracy: 0.7478
 96%|██████████████████████████████████████████████████████████████████▏  | 2399/2500 [30:13<01:20,  1.25it/s]Processed 2400/2500, Accuracy: 0.7508
100%|████████████████████████████████████████████████████████████████████▉| 2499/2500 [31:27<00:00,  1.11it/s]Processed 2500/2500, Accuracy: 0.7568
100%|█████████████████████████████████████████████████████████████████████| 2500/2500 [31:28<00:00,  1.32it/s]

Evaluation completed!
Accuracy: 0.7568 (1892/2500)
Results saved to: results.json